# dlist

实现一个线程安全的通用双链表

## 内部细节

- 双链表包含一个哑节点，用于简化处理，头指针始终指向哑节点
- 链表空时，尾指针指向哑节点；否则指向最后一个元素
- 注意数据节点的idx，从1开始

## API

### dlist_create

- 功能：创建链表
- 输入参数：（1）链表最大容量（2）打印链表节点的回调函数
- 输出参数：N/A
- 返回值：指向链表的指针

### dlist_destroy

- 功能：销毁链表
- 输入参数：指向链表的指针
- 输出参数：N/A
- 返回值：操作错误码

### dlist_display

- 功能：根据创建时输入的打印回调，按序打印链表
- 输入参数：（1）指向链表的指针（2）顺序or逆序
- 输出参数：N/A
- 返回值：操作错误码

### dlist_get_size

- 功能：获取链表当前长度
- 输入参数：指向链表的指针
- 输出参数：长度
- 返回值：操作错误码

### dlist_get_data / dlist_get_head / dlist_get_tail

`dlist_get_data`

- 功能：获取链表某一位置的元素，copy给输出参数data
- 输入参数：（1）指向链表的指针（2）节点的序号（4）数据的长度，用于拷贝
- 输出参数：（3）指向数据的指针data
- 返回值：操作错误码

内部基于`dlist_get_data`，提供返回头部/尾部元素数据的接口

### dlist_insert / dlist_append_tail / dlist_append_head

`dlist_insert`

- 功能：链表插入元素
- 输入参数：（1）指向链表的指针（2）插入后节点的序号（3）data
- 输出参数：N/A
- 返回值：操作错误码

链表插入原理：
1. 找到插入位置的前后节点
2. 修改前后节点，以及新节点的next/prior
3. 注意边界情况的处理：（1）插入尾部，需要移动尾指针

`dlist_append_tail` / `dlist_append_head`

内部基于`dlist_insert`，提供头插/尾插接口

### dlist_remove / dlist_remove_head / dlist_remove_tail

`dlist_remove`

- 功能：链表移除元素
- 输入参数：（1）指向链表的指针（2）移除元素的序号
- 输出参数：N/A
- 返回值：操作错误码

链表移除原理：
1. 找到移除位置的前后节点
2. 修改前后节点的next/prior，跳过移除的元素
3. 注意边界情况的处理：（1）移除尾部，需要移动尾指针

`dlist_remove_head` / `dlist_remove_tail`

内部基于`dlist_remove`，提供头/尾移除接口

## 内存管理

链表无法得知存储数据的大小及来源，所以由调用模块自行管理数据内存

节点内存由DLIST模块自行管理

## 线程安全

使用互斥锁保证线程安全，对于链表这种简单数据结构，使用粗粒度锁即可
